webpackJsonp([61],{2313:function(e,n,t){var o=t(2)(t(2564),t(2565),function(e){t(2562)},null,null);e.exports=o.exports},2562:function(e,n,t){var o=t(2563);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(2279)("0a6dd56f",o,!0,{})},2563:function(e,n,t){(e.exports=t(2278)(!0)).push([e.i,".role-permission{width:100%;height:100%}.role-permission .content{border:1px solid #2b2f3b}.role-permission .content .el-form-item{margin-bottom:5px}.role-permission .content .el-form--inline .el-form-item__label{width:182px}.role-permission .content .el-form--inline .el-form-item__content{width:90px}.role-permission .content .header{background:#353945}.role-permission .content .listItem{margin:0!important;margin-bottom:20px;-webkit-box-shadow:0 -1px #2b2f3b;box-shadow:0 -1px #2b2f3b}.role-permission .content .grid-content{text-align:center;margin:15px auto}.role-permission .content .grid-content .title{display:block;font-size:15px;border:0}","",{version:3,sources:["/Users/bys/工作/Bafang/BESST/besst-client/src/views/nl/role/role-permission.vue"],names:[],mappings:"AACA,iBACE,WAAY,AACZ,WAAa,CACd,AACD,0BACI,wBAA0B,CAC7B,AACD,wCACM,iBAAmB,CACxB,AACD,gEACM,WAAa,CAClB,AACD,kEACM,UAAY,CACjB,AACD,kCACM,kBAAoB,CACzB,AACD,oCACM,mBAAqB,AACrB,mBAAoB,AACpB,kCAAmC,AAC3B,yBAA2B,CACxC,AACD,wCACM,kBAAmB,AACnB,gBAAkB,CACvB,AACD,+CACQ,cAAe,AACf,eAAgB,AAChB,QAAU,CACjB",file:"role-permission.vue",sourcesContent:["\n.role-permission {\n  width: 100%;\n  height: 100%;\n}\n.role-permission .content {\n    border: 1px solid #2b2f3b;\n}\n.role-permission .content .el-form-item {\n      margin-bottom: 5px;\n}\n.role-permission .content .el-form--inline .el-form-item__label {\n      width: 182px;\n}\n.role-permission .content .el-form--inline .el-form-item__content {\n      width: 90px;\n}\n.role-permission .content .header {\n      background: #353945;\n}\n.role-permission .content .listItem {\n      margin: 0 !important;\n      margin-bottom: 20px;\n      -webkit-box-shadow: 0 -1px #2b2f3b;\n              box-shadow: 0 -1px #2b2f3b;\n}\n.role-permission .content .grid-content {\n      text-align: center;\n      margin: 15px auto;\n}\n.role-permission .content .grid-content .title {\n        display: block;\n        font-size: 15px;\n        border: 0;\n}\n"],sourceRoot:""}])},2564:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=m(t(337)),i=m(t(3)),s=m(t(7)),r=m(t(5)),l=m(t(9)),a=m(t(10)),c=m(t(8));function m(e){return e&&e.__esModule?e:{default:e}}n.default={inject:["reload"],data:function(){return{roleId:"",loading:!1,value3:!1,roleForm:{}}},i18n:{messages:{fr:c.default.Component.Order.Save,en:r.default.Component.Order.Save,zh:s.default.Component.Order.Save,de:l.default.Component.Order.Save,nl:a.default.Component.Order.Save}},computed:{},mounted:function(){var e=this;this.roleId=this.$route.query.roleId,e.loading=!0,e.getAllPermission().then(function(n){e.loading=!1,e.roleForm=n})},methods:{onChange:function(e,n,t){switch(e){case"ALL":n.components.forEach(function(e){e.permissioned=t});break;case"CHECK":n.components.filter(function(e){return!0===e.permissioned}).length>0&&(n.permissioned=!0)}},onSave:function(){var e=this,n=this;this.loading=!0;var t=[];this.roleForm.filter(function(e){return!0===e.permissioned}).forEach(function(e){t.push({role_id:n.roleId,permission_id:e.permissionId});var i=e.components.filter(function(e){return!0===e.permissioned}).map(function(e){return{role_id:n.roleId,permission_id:e.permissionId}});t=[].concat((0,o.default)(t),(0,o.default)(i))}),this.postPermissionBulk(t,{role_id:n.roleId}).then(function(n){if(e.loading=!1,-2===n.code)throw n.messages;e.$message({message:"Save Successfully",type:"success"}),e.reloadPermission()}).catch(function(n){e.loading=!1,e.$message({message:n,type:"error"})})},reloadPermission:function(){var e=this;this.loading=!0,i.default.Api.request({method:"GET",url:"/nl/public/permission/permissioned"}).then(function(n){var t=n;e.$store.commit("changePermissions",t),e.loading=!1,e.loading=!1,e.reload()})},getAllPermission:function(){return i.default.Api.request({method:"GET",url:"/nl/public/permission/nodes",data:{role_id:this.roleId}})},postPermissionBulk:function(e,n){return i.default.Api.request({method:"POST",url:"/nl/public/role/permission/rel/save-batch",data:e,params:n})}}}},2565:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"role-permission"},[t("div",{staticClass:"header"},[t("div",{staticClass:"btn-group-inline"},[t("div",{staticClass:"icons"},[t("div",{staticClass:"icon-item back",attrs:{title:"back"},on:{click:function(n){return e.$router.back()}}})])]),e._v(" "),t("label",{staticClass:"title"},[e._v("Permission")]),e._v(" "),t("div",{staticClass:"btn-group-top"},[t("div",{staticClass:"icons"},[t("div",{staticClass:"icon-item save",attrs:{title:"save"},on:{click:e.onSave}})])])]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"content-wrap"},[t("div",{staticClass:"content"},[t("el-row",{staticClass:"header listItem",attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"grid-content"},[t("label",{staticClass:"title"},[e._v("Module permissions")])])]),e._v(" "),t("el-col",{attrs:{span:16}},[t("div",{staticClass:"grid-content"},[t("label",{staticClass:"title"},[e._v("Functional authority")])])])],1),e._v(" "),e._l(e.roleForm,function(n,o){return t("div",{key:o},[t("el-row",{staticClass:"listItem",attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"grid-content"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-form-item",{attrs:{label:n.permissionName}},[t("el-switch",{attrs:{"on-text":"ON","off-text":"OFF","on-color":"#13ce66","off-color":"#ff4949"},on:{change:function(t){return e.onChange("ALL",n,t)}},model:{value:n.permissioned,callback:function(t){e.$set(n,"permissioned",t)},expression:"item.permissioned"}})],1)],1)],1)]),e._v(" "),t("el-col",{attrs:{span:16}},[t("div",{staticClass:"grid-content"},e._l(n.components,function(o,i){return t("el-form",{key:i,staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-form-item",{attrs:{label:o.permissionName}},[t("el-switch",{attrs:{"on-text":"ON","off-text":"OFF","on-color":"#13ce66","off-color":"#ff4949"},on:{change:function(t){return e.onChange("CHECK",n,t)}},model:{value:o.permissioned,callback:function(n){e.$set(o,"permissioned",n)},expression:"comp.permissioned"}})],1)],1)}),1)])],1)],1)})],2)])])},staticRenderFns:[]}}});
//# sourceMappingURL=61.aaa0b971dc31450e9366.js.map